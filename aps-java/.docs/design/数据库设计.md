# APS 排产系统（四大工艺、辆/班）MySQL 建表语句（DDL，全量）
- 说明  
   - MySQL 8.0+，InnoDB，utf8mb4  
   - 主键 id BIGINT（雪花ID，应用生成）
   - 通用字段：created_time/created_by/updated_time/updated_by/deleted
   - 不强制外键（靠代码与索引保证一致性）
   - JSON 字段使用 JSON 类型
   - 如需我把字段注释再细化到业务口径/枚举值，请告诉我

1. 系统与权限（6张） 
   1. sys_user
      ```sql
      CREATE TABLE IF NOT EXISTS sys_user (
      id BIGINT NOT NULL COMMENT 'PK 雪花ID',
      username VARCHAR(64) NOT NULL COMMENT '登录名',
      password_hash VARCHAR(255) NOT NULL COMMENT '密码哈希',
      role VARCHAR(16) NOT NULL COMMENT '角色：admin/user',
      real_name VARCHAR(64) NULL COMMENT '姓名',
      mobile VARCHAR(32) NULL COMMENT '手机号',
      email VARCHAR(128) NULL COMMENT '邮箱',
      status TINYINT NOT NULL DEFAULT 1 COMMENT '1启用0禁用',
      last_login_time DATETIME(3) NULL COMMENT '最近登录时间',
      created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
      created_by BIGINT NULL,
      updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
      updated_by BIGINT NULL,
      deleted TINYINT NOT NULL DEFAULT 0 COMMENT '0否1是',
      PRIMARY KEY (id),
      UNIQUE KEY uk_username (username),
      KEY idx_role (role),
      KEY idx_status (status),
      KEY idx_created_time (created_time)
      ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表';
      ```
      2. sys_audit_log
      ```sql
      CREATE TABLE IF NOT EXISTS sys_audit_log (
      id BIGINT NOT NULL COMMENT 'PK',
      user_id BIGINT NULL COMMENT '操作人',
      action VARCHAR(64) NOT NULL COMMENT '动作',
      object_type VARCHAR(64) NOT NULL COMMENT '对象类型',
      object_id BIGINT NULL COMMENT '对象ID',
      request_id VARCHAR(64) NULL COMMENT 'traceId',
      detail JSON NULL COMMENT '详情',
      created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
      PRIMARY KEY (id),
      KEY idx_obj (object_type, object_id),
      KEY idx_user_time (user_id, created_time),
      KEY idx_time (created_time)
      ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='审计日志';
      ```
      3. sys_dict_type
      ```sql
      CREATE TABLE IF NOT EXISTS sys_dict_type (
      id BIGINT NOT NULL,
      type_code VARCHAR(64) NOT NULL COMMENT '类型编码',
      type_name VARCHAR(128) NOT NULL COMMENT '类型名称',
      status TINYINT NOT NULL DEFAULT 1 COMMENT '1启用0停用',
      remark VARCHAR(255) NULL,
      created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
      created_by BIGINT NULL,
      updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
      updated_by BIGINT NULL,
      deleted TINYINT NOT NULL DEFAULT 0,
      PRIMARY KEY (id),
      UNIQUE KEY uk_type_code (type_code),
      KEY idx_status (status)
      ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='字典类型';
      ```
      4. sys_dict_item
      ```sql
      CREATE TABLE IF NOT EXISTS sys_dict_item (
      id BIGINT NOT NULL,
      type_id BIGINT NOT NULL COMMENT '字典类型ID',
      item_key VARCHAR(64) NOT NULL COMMENT '键',
      item_value VARCHAR(128) NOT NULL COMMENT '值',
      sort_no INT NOT NULL DEFAULT 0 COMMENT '排序',
      status TINYINT NOT NULL DEFAULT 1 COMMENT '1启用0停用',
      remark VARCHAR(255) NULL,
      created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
      created_by BIGINT NULL,
      updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
      updated_by BIGINT NULL,
      deleted TINYINT NOT NULL DEFAULT 0,
      PRIMARY KEY (id),
      UNIQUE KEY uk_type_key (type_id, item_key),
      KEY idx_type_sort (type_id, sort_no),
      KEY idx_status (status)
      ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='字典项';
      ```
      1.5 sys_config
      CREATE TABLE IF NOT EXISTS sys_config (
      id BIGINT NOT NULL,
      cfg_key VARCHAR(128) NOT NULL,
      cfg_value VARCHAR(2048) NOT NULL,
      cfg_group VARCHAR(64) NULL,
      status TINYINT NOT NULL DEFAULT 1,
      remark VARCHAR(255) NULL,
      created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
      created_by BIGINT NULL,
      updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
      updated_by BIGINT NULL,
      deleted TINYINT NOT NULL DEFAULT 0,
      PRIMARY KEY (id),
      UNIQUE KEY uk_cfg_key (cfg_key),
      KEY idx_group (cfg_group),
      KEY idx_status (status)
      ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='系统参数';
      1.6 sys_api_client
      CREATE TABLE IF NOT EXISTS sys_api_client (
      id BIGINT NOT NULL,
      client_code VARCHAR(64) NOT NULL,
      client_name VARCHAR(128) NOT NULL,
      access_key VARCHAR(128) NOT NULL,
      secret_key_hash VARCHAR(255) NOT NULL,
      ip_whitelist VARCHAR(1024) NULL,
      status TINYINT NOT NULL DEFAULT 1,
      remark VARCHAR(255) NULL,
      created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
      created_by BIGINT NULL,
      updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
      updated_by BIGINT NULL,
      deleted TINYINT NOT NULL DEFAULT 0,
      PRIMARY KEY (id),
      UNIQUE KEY uk_client_code (client_code),
      UNIQUE KEY uk_access_key (access_key),
      KEY idx_status (status)
      ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='API调用方';

2. 主数据（8张）
   2.1 md_model
   CREATE TABLE IF NOT EXISTS md_model (
   id BIGINT NOT NULL,
   model_code VARCHAR(64) NOT NULL,
   model_name VARCHAR(128) NOT NULL,
   platform VARCHAR(64) NULL,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_model_code (model_code),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='车型/产品';
   2.2 md_item
   CREATE TABLE IF NOT EXISTS md_item (
   id BIGINT NOT NULL,
   item_code VARCHAR(64) NOT NULL,
   item_name VARCHAR(255) NOT NULL,
   item_type TINYINT NOT NULL COMMENT '1原料2半成品3成品4辅料',
   uom VARCHAR(16) NULL,
   spec VARCHAR(255) NULL,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_item_code (item_code),
   KEY idx_type (item_type),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='物料主数据';
   2.3 md_bom
   CREATE TABLE IF NOT EXISTS md_bom (
   id BIGINT NOT NULL,
   bom_code VARCHAR(64) NOT NULL,
   model_id BIGINT NOT NULL,
   version VARCHAR(32) NOT NULL,
   effective_from DATETIME(3) NOT NULL,
   effective_to DATETIME(3) NULL,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_bom_code (bom_code),
   KEY idx_model_ver (model_id, version),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='BOM主表(多版本)';
   2.4 md_bom_item
   CREATE TABLE IF NOT EXISTS md_bom_item (
   id BIGINT NOT NULL,
   bom_id BIGINT NOT NULL,
   parent_item_code VARCHAR(64) NULL,
   item_code VARCHAR(64) NOT NULL,
   qty DECIMAL(18,6) NOT NULL,
   loss_rate DECIMAL(10,6) NOT NULL DEFAULT 0,
   level_no INT NOT NULL DEFAULT 1,
   is_optional TINYINT NOT NULL DEFAULT 0,
   option_group VARCHAR(64) NULL,
   alt_group VARCHAR(64) NULL,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_bom (bom_id),
   KEY idx_item (item_code),
   KEY idx_parent (parent_item_code)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='BOM明细(多层级)';
   2.5 md_item_substitute
   CREATE TABLE IF NOT EXISTS md_item_substitute (
   id BIGINT NOT NULL,
   alt_group VARCHAR(64) NOT NULL,
   item_code VARCHAR(64) NOT NULL,
   priority_no INT NOT NULL DEFAULT 1,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_group_priority (alt_group, priority_no),
   KEY idx_item (item_code)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='替代料关系';
   2.6 md_item_stock
   CREATE TABLE IF NOT EXISTS md_item_stock (
   id BIGINT NOT NULL,
   item_code VARCHAR(64) NOT NULL,
   warehouse_code VARCHAR(64) NOT NULL,
   biz_date DATE NOT NULL,
   qty_onhand DECIMAL(18,6) NOT NULL DEFAULT 0,
   qty_available DECIMAL(18,6) NOT NULL DEFAULT 0,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_item_wh_date (item_code, warehouse_code, biz_date),
   KEY idx_item (item_code),
   KEY idx_date (biz_date)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='库存快照(齐套校验可用)';
   2.7 md_vin_rule
   CREATE TABLE IF NOT EXISTS md_vin_rule (
   id BIGINT NOT NULL,
   rule_code VARCHAR(64) NOT NULL,
   model_id BIGINT NOT NULL,
   rule_json JSON NOT NULL,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_rule_code (rule_code),
   KEY idx_model (model_id),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='VIN规则';
   2.8 md_param_profile
   CREATE TABLE IF NOT EXISTS md_param_profile (
   id BIGINT NOT NULL,
   profile_code VARCHAR(64) NOT NULL,
   profile_name VARCHAR(128) NOT NULL,
   param_json JSON NOT NULL,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_profile_code (profile_code),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='参数配置集';

3. 工艺路线与约束（6张）
   3.1 md_route
   CREATE TABLE IF NOT EXISTS md_route (
   id BIGINT NOT NULL,
   route_code VARCHAR(64) NULL,
   model_id BIGINT NOT NULL,
   process_type TINYINT NOT NULL COMMENT '1冲压2焊装3涂装4总装',
   version VARCHAR(32) NOT NULL,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_model_process_ver (model_id, process_type, version),
   UNIQUE KEY uk_route_code (route_code),
   KEY idx_model (model_id),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工艺路线(四大工艺，多版本)';
   3.2 md_operation
   CREATE TABLE IF NOT EXISTS md_operation (
   id BIGINT NOT NULL,
   route_id BIGINT NOT NULL,
   op_code VARCHAR(64) NOT NULL,
   op_name VARCHAR(128) NOT NULL,
   seq_no INT NOT NULL,
   std_minutes_per_unit INT NOT NULL DEFAULT 0 COMMENT '分钟/辆(估算)',
   setup_minutes INT NOT NULL DEFAULT 0 COMMENT '准备/换型分钟',
   station_group VARCHAR(64) NULL COMMENT '可选工位组',
   constraint_json JSON NULL COMMENT '工艺约束参数',
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_route_seq (route_id, seq_no),
   KEY idx_op_code (op_code),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工序定义';
   3.3 md_op_resource_req
   CREATE TABLE IF NOT EXISTS md_op_resource_req (
   id BIGINT NOT NULL,
   op_id BIGINT NOT NULL,
   resource_type TINYINT NOT NULL COMMENT '1产线2工位3设备4模具5人力组',
   resource_id BIGINT NOT NULL,
   qty INT NOT NULL DEFAULT 1,
   is_mandatory TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_op (op_id),
   KEY idx_res (resource_type, resource_id)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工序资源需求';
   3.4 md_setup_matrix
   CREATE TABLE IF NOT EXISTS md_setup_matrix (
   id BIGINT NOT NULL,
   process_type TINYINT NOT NULL COMMENT '1~4',
   from_key VARCHAR(64) NOT NULL,
   to_key VARCHAR(64) NOT NULL,
   setup_minutes INT NOT NULL DEFAULT 0,
   setup_cost DECIMAL(10,2) NOT NULL DEFAULT 0,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_process (process_type),
   KEY idx_from_to (process_type, from_key, to_key),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='换型/换模/换色矩阵';
   3.5 md_constraint_rule
   CREATE TABLE IF NOT EXISTS md_constraint_rule (
   id BIGINT NOT NULL,
   rule_code VARCHAR(64) NOT NULL,
   rule_name VARCHAR(128) NOT NULL,
   scope_type TINYINT NOT NULL DEFAULT 0 COMMENT '0全局1工艺2产线3车型',
   scope_id BIGINT NULL,
   rule_json JSON NOT NULL,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_rule_code (rule_code),
   KEY idx_scope (scope_type, scope_id),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='约束规则配置';
   3.6 md_quality_checkpoint
   CREATE TABLE IF NOT EXISTS md_quality_checkpoint (
   id BIGINT NOT NULL,
   process_type TINYINT NOT NULL,
   op_code VARCHAR(64) NOT NULL,
   checkpoint_code VARCHAR(64) NOT NULL,
   checkpoint_name VARCHAR(128) NOT NULL,
   spec_json JSON NULL,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_cp (checkpoint_code),
   KEY idx_process (process_type),
   KEY idx_op (op_code),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='质检关卡定义';

4. 组织与资源（10张）
   4.1 md_workshop
   CREATE TABLE IF NOT EXISTS md_workshop (
   id BIGINT NOT NULL,
   workshop_code VARCHAR(64) NOT NULL,
   workshop_name VARCHAR(128) NOT NULL,
   process_type TINYINT NULL COMMENT '可选：车间工艺',
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_workshop_code (workshop_code),
   KEY idx_process (process_type),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='车间';
   4.2 md_line
   CREATE TABLE IF NOT EXISTS md_line (
   id BIGINT NOT NULL,
   workshop_id BIGINT NOT NULL,
   line_code VARCHAR(64) NOT NULL,
   line_name VARCHAR(128) NOT NULL,
   process_type TINYINT NOT NULL COMMENT '1~4',
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_line_code (line_code),
   KEY idx_workshop (workshop_id),
   KEY idx_process (process_type),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='产线';
   4.3 md_station
   CREATE TABLE IF NOT EXISTS md_station (
   id BIGINT NOT NULL,
   line_id BIGINT NOT NULL,
   station_code VARCHAR(64) NOT NULL,
   station_name VARCHAR(128) NOT NULL,
   capacity_qty_per_shift INT NOT NULL DEFAULT 0 COMMENT '辆/班',
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_station_code (station_code),
   KEY idx_line (line_id),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工位';
   4.4 md_station_group
   CREATE TABLE IF NOT EXISTS md_station_group (
   id BIGINT NOT NULL,
   group_code VARCHAR(64) NOT NULL,
   group_name VARCHAR(128) NOT NULL,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_group_code (group_code),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工位组';
   4.5 md_station_group_rel
   CREATE TABLE IF NOT EXISTS md_station_group_rel (
   id BIGINT NOT NULL,
   group_id BIGINT NOT NULL,
   station_id BIGINT NOT NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_group_station (group_id, station_id),
   KEY idx_station (station_id)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工位组-工位关系';
   4.6 md_equipment
   CREATE TABLE IF NOT EXISTS md_equipment (
   id BIGINT NOT NULL,
   station_id BIGINT NOT NULL,
   equip_code VARCHAR(64) NOT NULL,
   equip_name VARCHAR(128) NOT NULL,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_equip_code (equip_code),
   KEY idx_station (station_id),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='设备';
   4.7 md_tooling
   CREATE TABLE IF NOT EXISTS md_tooling (
   id BIGINT NOT NULL,
   tooling_code VARCHAR(64) NOT NULL,
   tooling_name VARCHAR(128) NOT NULL,
   tooling_type TINYINT NOT NULL COMMENT '1模具2夹具3检具',
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_tooling_code (tooling_code),
   KEY idx_type (tooling_type),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='模具/工装';
   4.8 md_tooling_bind
   CREATE TABLE IF NOT EXISTS md_tooling_bind (
   id BIGINT NOT NULL,
   tooling_id BIGINT NOT NULL,
   resource_type TINYINT NOT NULL COMMENT '2工位/3设备',
   resource_id BIGINT NOT NULL,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_tooling (tooling_id),
   KEY idx_resource (resource_type, resource_id),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工装可用关系';
   4.9 md_labor_group
   CREATE TABLE IF NOT EXISTS md_labor_group (
   id BIGINT NOT NULL,
   labor_code VARCHAR(64) NOT NULL,
   labor_name VARCHAR(128) NOT NULL,
   headcount INT NOT NULL DEFAULT 0,
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_labor_code (labor_code),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='人力组';
   4.10 md_labor_group_rel
   CREATE TABLE IF NOT EXISTS md_labor_group_rel (
   id BIGINT NOT NULL,
   labor_id BIGINT NOT NULL,
   station_id BIGINT NOT NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_labor_station (labor_id, station_id),
   KEY idx_station (station_id)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='人力组-工位关系';

5. 资源日历（4张）
   5.1 cal_day
   CREATE TABLE IF NOT EXISTS cal_day (
   id BIGINT NOT NULL,
   resource_type TINYINT NOT NULL COMMENT '1产线2工位3设备4模具5人力组',
   resource_id BIGINT NOT NULL,
   biz_date DATE NOT NULL,
   is_workday TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_day (resource_type, resource_id, biz_date),
   KEY idx_date (biz_date),
   KEY idx_res (resource_type, resource_id)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='资源日历(日)';
   5.2 cal_shift
   CREATE TABLE IF NOT EXISTS cal_shift (
   id BIGINT NOT NULL,
   day_id BIGINT NOT NULL,
   shift_code VARCHAR(32) NOT NULL,
   start_time TIME NOT NULL,
   end_time TIME NOT NULL,
   capacity_qty INT NOT NULL DEFAULT 0 COMMENT '辆/班容量',
   status TINYINT NOT NULL DEFAULT 1,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_day (day_id),
   KEY idx_shift (shift_code),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='资源日历(班次)';
   5.3 cal_maintenance_window
   CREATE TABLE IF NOT EXISTS cal_maintenance_window (
   id BIGINT NOT NULL,
   resource_type TINYINT NOT NULL,
   resource_id BIGINT NOT NULL,
   start_time DATETIME(3) NOT NULL,
   end_time DATETIME(3) NOT NULL,
   reason VARCHAR(255) NULL,
   status TINYINT NOT NULL DEFAULT 1,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_res_time (resource_type, resource_id, start_time),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='维护窗口';
   5.4 cal_holiday
   CREATE TABLE IF NOT EXISTS cal_holiday (
   id BIGINT NOT NULL,
   biz_date DATE NOT NULL,
   name VARCHAR(64) NOT NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_date (biz_date)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='节假日';

6. 订单与计划（8张）
   6.1 ord_sales
   CREATE TABLE IF NOT EXISTS ord_sales (
   id BIGINT NOT NULL,
   sales_no VARCHAR(64) NOT NULL,
   customer_code VARCHAR(64) NULL,
   model_id BIGINT NOT NULL,
   qty INT NOT NULL,
   due_date DATE NOT NULL,
   priority INT NOT NULL DEFAULT 0,
   status TINYINT NOT NULL DEFAULT 0 COMMENT '0新建1已审核2已转生产9取消',
   source_payload JSON NULL,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_sales_no (sales_no),
   KEY idx_due (due_date, priority),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='销售订单';
   6.2 ord_prod
   CREATE TABLE IF NOT EXISTS ord_prod (
   id BIGINT NOT NULL,
   prod_no VARCHAR(64) NOT NULL,
   sales_id BIGINT NULL,
   order_kind TINYINT NOT NULL COMMENT '1常规2紧急3定制4插单5返工',
   model_id BIGINT NOT NULL,
   bom_id BIGINT NOT NULL,
   route_version VARCHAR(32) NOT NULL,
   qty INT NOT NULL,
   due_date DATE NOT NULL,
   priority INT NOT NULL DEFAULT 0,
   status TINYINT NOT NULL DEFAULT 0 COMMENT '0新建1待审批2已审批3已排产4执行中5完成9取消',
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_prod_no (prod_no),
   KEY idx_sales (sales_id),
   KEY idx_due (due_date, priority),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='生产订单';
   6.3 ord_prod_attr
   CREATE TABLE IF NOT EXISTS ord_prod_attr (
   id BIGINT NOT NULL,
   ord_id BIGINT NOT NULL,
   attr_key VARCHAR(64) NOT NULL,
   attr_value VARCHAR(128) NOT NULL,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_order (ord_id),
   KEY idx_attr (attr_key, attr_value)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='生产订单属性(颜色等)';
   6.4 flow_approve_task
   CREATE TABLE IF NOT EXISTS flow_approve_task (
   id BIGINT NOT NULL,
   object_type VARCHAR(32) NOT NULL,
   object_id BIGINT NOT NULL,
   step_no INT NOT NULL,
   step_name VARCHAR(64) NOT NULL,
   assignee_role VARCHAR(16) NOT NULL COMMENT 'admin/user(简化)',
   status TINYINT NOT NULL DEFAULT 0 COMMENT '0待处理1通过2驳回',
   comment VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_obj (object_type, object_id),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='审批任务';
   6.5 plan_mps
   CREATE TABLE IF NOT EXISTS plan_mps (
   id BIGINT NOT NULL,
   mps_no VARCHAR(64) NOT NULL,
   start_date DATE NOT NULL,
   end_date DATE NOT NULL,
   status TINYINT NOT NULL DEFAULT 0 COMMENT '0草稿1审批中2已批准3关闭',
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_mps_no (mps_no),
   KEY idx_range (start_date, end_date),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='MPS主表';
   6.6 plan_mps_item
   CREATE TABLE IF NOT EXISTS plan_mps_item (
   id BIGINT NOT NULL,
   mps_id BIGINT NOT NULL,
   biz_date DATE NOT NULL,
   model_id BIGINT NOT NULL,
   qty INT NOT NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_mps (mps_id, biz_date),
   KEY idx_model_date (model_id, biz_date)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='MPS明细';
   6.7 plan_mrp
   CREATE TABLE IF NOT EXISTS plan_mrp (
   id BIGINT NOT NULL,
   mrp_no VARCHAR(64) NOT NULL,
   mps_id BIGINT NOT NULL,
   status TINYINT NOT NULL DEFAULT 0 COMMENT '0生成中1完成2失败',
   result_payload JSON NULL,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_mrp_no (mrp_no),
   KEY idx_mps (mps_id),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='MRP主表';
   6.8 plan_mrp_item
   CREATE TABLE IF NOT EXISTS plan_mrp_item (
   id BIGINT NOT NULL,
   mrp_id BIGINT NOT NULL,
   item_code VARCHAR(64) NOT NULL,
   req_date DATE NOT NULL,
   req_qty DECIMAL(18,6) NOT NULL DEFAULT 0,
   supply_qty DECIMAL(18,6) NOT NULL DEFAULT 0,
   shortage_qty DECIMAL(18,6) NOT NULL DEFAULT 0,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_mrp_item (mrp_id, item_code),
   KEY idx_date (req_date)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='MRP明细';

7. 排产（9张）
   7.1 sch_job
   CREATE TABLE IF NOT EXISTS sch_job (
   id BIGINT NOT NULL,
   job_no VARCHAR(64) NOT NULL,
   horizon_start DATE NOT NULL,
   horizon_end DATE NOT NULL,
   scope_json JSON NULL,
   objective_json JSON NULL,
   constraint_json JSON NULL,
   status TINYINT NOT NULL DEFAULT 0 COMMENT '0待运行1运行中2成功3失败4不可行',
   engine_trace VARCHAR(128) NULL,
   error_msg VARCHAR(1024) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_job_no (job_no),
   KEY idx_status (status),
   KEY idx_created_time (created_time)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='排产任务';
   7.2 sch_plan
   CREATE TABLE IF NOT EXISTS sch_plan (
   id BIGINT NOT NULL,
   job_id BIGINT NOT NULL,
   plan_no VARCHAR(64) NOT NULL,
   is_best TINYINT NOT NULL DEFAULT 0,
   kpi_json JSON NULL,
   status TINYINT NOT NULL DEFAULT 0 COMMENT '0草稿1已发布2作废',
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_job_best (job_id, is_best),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='排产方案';
   7.3 sch_plan_bucket
   CREATE TABLE IF NOT EXISTS sch_plan_bucket (
   id BIGINT NOT NULL,
   plan_id BIGINT NOT NULL,
   process_type TINYINT NOT NULL COMMENT '1~4',
   line_id BIGINT NOT NULL,
   biz_date DATE NOT NULL,
   shift_code VARCHAR(32) NOT NULL,
   prod_order_id BIGINT NOT NULL,
   seq_no INT NOT NULL,
   qty INT NOT NULL COMMENT '分配数量(辆)',
   from_setup_key VARCHAR(64) NULL,
   to_setup_key VARCHAR(64) NULL,
   setup_minutes INT NOT NULL DEFAULT 0,
   setup_cost DECIMAL(10,2) NOT NULL DEFAULT 0,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_plan_slot (plan_id, biz_date, shift_code, line_id),
   KEY idx_order (prod_order_id),
   KEY idx_process (process_type),
   KEY idx_line_date (line_id, biz_date)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='方案明细(班次桶)';
   7.4 sch_plan_conflict
   CREATE TABLE IF NOT EXISTS sch_plan_conflict (
   id BIGINT NOT NULL,
   plan_id BIGINT NOT NULL,
   conflict_type VARCHAR(64) NOT NULL,
   level TINYINT NOT NULL COMMENT '1提示2警告3致命',
   object_type VARCHAR(32) NULL,
   object_id BIGINT NULL,
   message VARCHAR(1024) NOT NULL,
   payload JSON NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_plan_level (plan_id, level),
   KEY idx_type (conflict_type),
   KEY idx_obj (object_type, object_id)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='方案冲突/不可行原因';
   7.5 sch_rule_snapshot
   CREATE TABLE IF NOT EXISTS sch_rule_snapshot (
   id BIGINT NOT NULL,
   job_id BIGINT NOT NULL,
   rule_json JSON NOT NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_job (job_id)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='排产规则快照';
   7.6 sch_engine_result_raw
   CREATE TABLE IF NOT EXISTS sch_engine_result_raw (
   id BIGINT NOT NULL,
   job_id BIGINT NOT NULL,
   raw_json JSON NOT NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_job (job_id)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='引擎原始返回(调试)';
   7.7 sch_wip_link
   CREATE TABLE IF NOT EXISTS sch_wip_link (
   id BIGINT NOT NULL,
   prod_order_id BIGINT NOT NULL,
   process_type TINYINT NOT NULL,
   plan_bucket_id BIGINT NULL,
   wo_id BIGINT NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_order_process (prod_order_id, process_type),
   KEY idx_bucket (plan_bucket_id),
   KEY idx_wo (wo_id)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='四大工艺串联绑定';
   7.8 sch_plan_stat
   CREATE TABLE IF NOT EXISTS sch_plan_stat (
   id BIGINT NOT NULL,
   plan_id BIGINT NOT NULL,
   otd_rate DECIMAL(10,4) NOT NULL DEFAULT 0,
   setup_times INT NOT NULL DEFAULT 0,
   avg_line_load DECIMAL(10,4) NOT NULL DEFAULT 0,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_plan (plan_id)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='方案统计';
   7.9 sch_manual_adjust_log
   CREATE TABLE IF NOT EXISTS sch_manual_adjust_log (
   id BIGINT NOT NULL,
   plan_id BIGINT NOT NULL,
   user_id BIGINT NOT NULL,
   change_json JSON NOT NULL,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_plan_time (plan_id, created_time),
   KEY idx_user_time (user_id, created_time)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='手动调整日志';

8. 执行（7张）
   8.1 exe_work_order
   CREATE TABLE IF NOT EXISTS exe_work_order (
   id BIGINT NOT NULL,
   wo_no VARCHAR(64) NOT NULL,
   plan_id BIGINT NOT NULL,
   plan_bucket_id BIGINT NOT NULL,
   process_type TINYINT NOT NULL,
   prod_order_id BIGINT NOT NULL,
   line_id BIGINT NOT NULL,
   biz_date DATE NOT NULL,
   shift_code VARCHAR(32) NOT NULL,
   seq_no INT NOT NULL,
   qty_planned INT NOT NULL,
   qty_done INT NOT NULL DEFAULT 0,
   status TINYINT NOT NULL DEFAULT 0 COMMENT '0待下达1已下达2执行中3暂停4完成9作废',
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_wo_no (wo_no),
   KEY idx_plan (plan_id),
   KEY idx_bucket (plan_bucket_id),
   KEY idx_order (prod_order_id),
   KEY idx_line_slot (line_id, biz_date, shift_code),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工单';
   8.2 exe_work_order_op
   CREATE TABLE IF NOT EXISTS exe_work_order_op (
   id BIGINT NOT NULL,
   wo_id BIGINT NOT NULL,
   op_code VARCHAR(64) NOT NULL,
   seq_no INT NOT NULL,
   station_id BIGINT NULL,
   qty_done INT NOT NULL DEFAULT 0,
   status TINYINT NOT NULL DEFAULT 0,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_wo (wo_id, seq_no),
   KEY idx_op (op_code),
   KEY idx_station (station_id)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工单工序执行(可选)';
   8.3 exe_report
   CREATE TABLE IF NOT EXISTS exe_report (
   id BIGINT NOT NULL,
   wo_id BIGINT NOT NULL,
   report_time DATETIME(3) NOT NULL,
   station_id BIGINT NULL,
   qty_good INT NOT NULL DEFAULT 0,
   qty_bad INT NOT NULL DEFAULT 0,
   detail_json JSON NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_wo_time (wo_id, report_time),
   KEY idx_station_time (station_id, report_time)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='报工记录';
   8.4 exe_exception
   CREATE TABLE IF NOT EXISTS exe_exception (
   id BIGINT NOT NULL,
   wo_id BIGINT NOT NULL,
   type VARCHAR(64) NOT NULL,
   level TINYINT NOT NULL DEFAULT 1,
   status TINYINT NOT NULL DEFAULT 0 COMMENT '0新建1处理中2关闭',
   `desc` VARCHAR(1024) NOT NULL,
   payload JSON NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_wo_status (wo_id, status),
   KEY idx_type (type),
   KEY idx_time (created_time)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='执行异常';
   8.5 exe_quality_record
   CREATE TABLE IF NOT EXISTS exe_quality_record (
   id BIGINT NOT NULL,
   wo_id BIGINT NOT NULL,
   vin VARCHAR(32) NULL,
   checkpoint_code VARCHAR(64) NOT NULL,
   check_time DATETIME(3) NOT NULL,
   result TINYINT NOT NULL COMMENT '1合格0不合格',
   detail_json JSON NULL,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_wo (wo_id),
   KEY idx_vin_time (vin, check_time),
   KEY idx_cp (checkpoint_code)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='质检记录';
   8.6 exe_device_data
   CREATE TABLE IF NOT EXISTS exe_device_data (
   id BIGINT NOT NULL,
   equip_id BIGINT NOT NULL,
   collect_time DATETIME(3) NOT NULL,
   data_json JSON NOT NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_equip_time (equip_id, collect_time)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='设备采集数据(可选)';
   8.7 exe_status_history
   CREATE TABLE IF NOT EXISTS exe_status_history (
   id BIGINT NOT NULL,
   wo_id BIGINT NOT NULL,
   from_status TINYINT NOT NULL,
   to_status TINYINT NOT NULL,
   operator_id BIGINT NOT NULL,
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_wo_time (wo_id, created_time),
   KEY idx_op_time (operator_id, created_time)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工单状态历史';

9. VIN与追溯（3张）
   9.1 trace_vin
   CREATE TABLE IF NOT EXISTS trace_vin (
   id BIGINT NOT NULL,
   vin VARCHAR(32) NOT NULL,
   model_id BIGINT NOT NULL,
   prod_order_id BIGINT NOT NULL,
   current_wo_id BIGINT NULL,
   status TINYINT NOT NULL DEFAULT 0 COMMENT '0创建1上线2完工',
   remark VARCHAR(255) NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   UNIQUE KEY uk_vin (vin),
   KEY idx_order (prod_order_id),
   KEY idx_status (status)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='VIN主表';
   9.2 trace_event
   CREATE TABLE IF NOT EXISTS trace_event (
   id BIGINT NOT NULL,
   vin VARCHAR(32) NOT NULL,
   process_type TINYINT NOT NULL,
   event_type VARCHAR(64) NOT NULL,
   event_time DATETIME(3) NOT NULL,
   station_id BIGINT NULL,
   payload JSON NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_vin_time (vin, event_time),
   KEY idx_type (event_type),
   KEY idx_station_time (station_id, event_time)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='VIN追溯事件';
   9.3 trace_component_bind
   CREATE TABLE IF NOT EXISTS trace_component_bind (
   id BIGINT NOT NULL,
   vin VARCHAR(32) NOT NULL,
   part_code VARCHAR(64) NOT NULL,
   serial_no VARCHAR(128) NOT NULL,
   bind_time DATETIME(3) NOT NULL,
   payload JSON NULL,
   created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
   created_by BIGINT NULL,
   updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
   updated_by BIGINT NULL,
   deleted TINYINT NOT NULL DEFAULT 0,
   PRIMARY KEY (id),
   KEY idx_vin (vin),
   KEY idx_part (part_code, serial_no),
   KEY idx_time (bind_time)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='VIN-组件绑定追溯';

10. 对接与消息（4张）
    10.1 intf_inbound_log
    CREATE TABLE IF NOT EXISTS intf_inbound_log (
    id BIGINT NOT NULL,
    source_system VARCHAR(32) NOT NULL,
    api_name VARCHAR(128) NOT NULL,
    request_id VARCHAR(64) NULL,
    payload JSON NULL,
    status TINYINT NOT NULL DEFAULT 0 COMMENT '0成功1失败',
    error_msg VARCHAR(1024) NULL,
    created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    created_by BIGINT NULL,
    updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
    updated_by BIGINT NULL,
    deleted TINYINT NOT NULL DEFAULT 0,
    PRIMARY KEY (id),
    KEY idx_sys_time (source_system, created_time),
    KEY idx_api_time (api_name, created_time),
    KEY idx_request (request_id)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='外部入站日志';
    10.2 intf_outbound_log
    CREATE TABLE IF NOT EXISTS intf_outbound_log (
    id BIGINT NOT NULL,
    target_system VARCHAR(32) NOT NULL,
    api_name VARCHAR(128) NOT NULL,
    request_id VARCHAR(64) NULL,
    payload JSON NULL,
    status TINYINT NOT NULL DEFAULT 0 COMMENT '0成功1失败',
    error_msg VARCHAR(1024) NULL,
    created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    created_by BIGINT NULL,
    updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
    updated_by BIGINT NULL,
    deleted TINYINT NOT NULL DEFAULT 0,
    PRIMARY KEY (id),
    KEY idx_sys_time (target_system, created_time),
    KEY idx_api_time (api_name, created_time),
    KEY idx_request (request_id)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='外部出站日志';
    10.3 mq_event_outbox
    CREATE TABLE IF NOT EXISTS mq_event_outbox (
    id BIGINT NOT NULL,
    event_type VARCHAR(64) NOT NULL,
    routing_key VARCHAR(128) NOT NULL,
    payload JSON NOT NULL,
    status TINYINT NOT NULL DEFAULT 0 COMMENT '0待发送1已发送2失败',
    retry_count INT NOT NULL DEFAULT 0,
    next_retry_time DATETIME(3) NULL,
    created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    created_by BIGINT NULL,
    updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
    updated_by BIGINT NULL,
    deleted TINYINT NOT NULL DEFAULT 0,
    PRIMARY KEY (id),
    KEY idx_status_time (status, created_time),
    KEY idx_next_retry (next_retry_time)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='Outbox事件表';
    10.4 mq_event_consume
    CREATE TABLE IF NOT EXISTS mq_event_consume (
    id BIGINT NOT NULL,
    event_id VARCHAR(64) NOT NULL,
    consumer VARCHAR(64) NOT NULL,
    status TINYINT NOT NULL DEFAULT 0 COMMENT '0成功1失败',
    created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    created_by BIGINT NULL,
    updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
    updated_by BIGINT NULL,
    deleted TINYINT NOT NULL DEFAULT 0,
    PRIMARY KEY (id),
    UNIQUE KEY uk_event_id (event_id),
    KEY idx_consumer_time (consumer, created_time)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='MQ消费幂等';

11. 报表与快照（4张，可选）
    11.1 rpt_kpi_daily
    CREATE TABLE IF NOT EXISTS rpt_kpi_daily (
    id BIGINT NOT NULL,
    biz_date DATE NOT NULL,
    process_type TINYINT NOT NULL,
    line_id BIGINT NOT NULL,
    plan_qty INT NOT NULL DEFAULT 0,
    done_qty INT NOT NULL DEFAULT 0,
    otd_rate DECIMAL(10,4) NOT NULL DEFAULT 0,
    setup_times INT NOT NULL DEFAULT 0,
    load_rate DECIMAL(10,4) NOT NULL DEFAULT 0,
    payload JSON NULL,
    created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    created_by BIGINT NULL,
    updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
    updated_by BIGINT NULL,
    deleted TINYINT NOT NULL DEFAULT 0,
    PRIMARY KEY (id),
    UNIQUE KEY uk_day (biz_date, process_type, line_id),
    KEY idx_date (biz_date),
    KEY idx_line (line_id)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='日KPI快照';
    11.2 rpt_bottleneck
    CREATE TABLE IF NOT EXISTS rpt_bottleneck (
    id BIGINT NOT NULL,
    plan_id BIGINT NOT NULL,
    bottleneck_type VARCHAR(64) NOT NULL,
    bottleneck_id BIGINT NOT NULL,
    score DECIMAL(10,4) NOT NULL DEFAULT 0,
    suggestion VARCHAR(1024) NULL,
    created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    created_by BIGINT NULL,
    updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
    updated_by BIGINT NULL,
    deleted TINYINT NOT NULL DEFAULT 0,
    PRIMARY KEY (id),
    KEY idx_plan (plan_id),
    KEY idx_type_score (bottleneck_type, score)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='瓶颈分析结果';
    11.3 snap_plan_publish
    CREATE TABLE IF NOT EXISTS snap_plan_publish (
    id BIGINT NOT NULL,
    plan_id BIGINT NOT NULL,
    snapshot_json JSON NOT NULL,
    created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    created_by BIGINT NULL,
    updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
    updated_by BIGINT NULL,
    deleted TINYINT NOT NULL DEFAULT 0,
    PRIMARY KEY (id),
    KEY idx_plan (plan_id)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='发布快照';
    11.4 snap_masterdata_version
    CREATE TABLE IF NOT EXISTS snap_masterdata_version (
    id BIGINT NOT NULL,
    snapshot_code VARCHAR(64) NOT NULL,
    snapshot_json JSON NOT NULL,
    created_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    created_by BIGINT NULL,
    updated_time DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
    updated_by BIGINT NULL,
    deleted TINYINT NOT NULL DEFAULT 0,
    PRIMARY KEY (id),
    UNIQUE KEY uk_snapshot_code (snapshot_code),
    KEY idx_time (created_time)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='主数据版本快照';
